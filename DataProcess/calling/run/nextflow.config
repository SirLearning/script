// Nextflow configuration for FastCall3 pipeline

// Process configuration
process {
    executor = 'local'
    
    // Default resource allocation
    cpus = 8       // Reduce default CPU usage
    memory = '32 GB' // Reduce default memory usage
    
    // Specific process configurations
    withName: 'prepareTaxaBamMap' {
        cpus = 4
        memory = '16 GB'
    }
    
    withName: 'fastcall3_disc' {
        cpus = 16      // Reduce from 32 to 16
        memory = '64 GB' // Reduce from 100GB to 64GB
    }
    
    withName: 'fastcall3_blib' {
        cpus = 8
        memory = '32 GB'
    }
    
    withName: 'fastcall3_scan' {
        cpus = 16
        memory = '64 GB'
    }
    
    withName: 'collect_results' {
        cpus = 4
        memory = '16 GB'
    }
}

// Executor configuration
executor {
    name = 'local'
    cpus = 96      // Update to actual system CPUs
    memory = '1800 GB' // Update to actual system memory
    queueSize = 15   // Increase queue size
}

// Report configuration
report {
    enabled = true
    file = 'pipeline_info/execution_report.html'
}

timeline {
    enabled = true
    file = 'pipeline_info/execution_timeline.html'
}

trace {
    enabled = true
    file = 'pipeline_info/execution_trace.txt'
}

dag {
    enabled = true
    file = 'pipeline_info/pipeline_dag.svg'
}

// Work directory cleanup
cleanup = false  // Keep work directory for debugging

// Resume configuration
resume = true

// Resource monitoring
monitor {
    enabled = true
    interval = '5min'
}
