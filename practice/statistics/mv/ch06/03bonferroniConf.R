source("ch06/02confEllipse.R")
xdata <- data.frame(PH = related_data$PH,
                    HD = related_data$HD)
p = ncol(xdata); n = nrow(xdata)
S = cov(xdata); xbar = colMeans(xdata)
conf.elipse(xdata, alpha = 1)
mu1.L = xbar[1]-sqrt(((n-1)*p/(n-p))*qf(0.95,p,n-p))*sqrt(S[1,1]/n)
mu1.U = xbar[1]+sqrt(((n-1)*p/(n-p))*qf(0.95,p,n-p))*sqrt(S[1,1]/n)
mu2.L = xbar[2]-sqrt(((n-1)*p/(n-p))*qf(0.95,p,n-p))*sqrt(S[2,2]/n)
mu2.U = xbar[2]+sqrt(((n-1)*p/(n-p))*qf(0.95,p,n-p))*sqrt(S[2,2]/n)
c(mu1.L, mu1.U); c(mu2.L, mu2.U)
lines(c(mu1.L, mu1.L), c(0, mu2.U), lty = 2, col = 2, lwd = 3)
lines(c(mu1.U, mu1.U), c(0, mu2.U), lty = 2, col = 2, lwd = 3)
lines(c(0, mu1.U), c(mu2.L, mu2.L), lty = 2, col = 2, lwd = 3)
lines(c(0, mu1.U), c(mu2.U, mu2.U), lty = 2, col = 2, lwd = 3)
mu1.LB = xbar[1]-qt(0.05/(2*p),n-1,lower.tail = F)*sqrt(S[1,1]/n)
mu1.UB = xbar[1]+qt(0.05/(2*p),n-1,lower.tail = F)*sqrt(S[1,1]/n)
mu2.LB = xbar[2]-qt(0.05/(2*p),n-1,lower.tail = F)*sqrt(S[2,2]/n)
mu2.UB = xbar[2]+qt(0.05/(2*p),n-1,lower.tail = F)*sqrt(S[2,2]/n)
c(mu1.LB, mu1.UB); c(mu2.LB, mu2.UB)
lines(c(mu1.LB, mu1.LB), c(0, mu2.UB), lty = 6, col = 4, lwd = 3)
lines(c(mu1.UB, mu1.UB), c(0, mu2.UB), lty = 6, col = 4, lwd = 3)
lines(c(0, mu1.UB), c(mu2.LB, mu2.LB), lty = 6, col = 4, lwd = 3)
lines(c(0, mu1.UB), c(mu2.UB, mu2.UB), lty = 6, col = 4, lwd = 3)


