#! /bin/bash

# count depth of bam files
## $1: depth prefix
## $2: bam paths

mapfile -t prefix < plist"$1".txt
size=${#prefix[@]}
echo "prefix loaded: ${#prefix[@]}"
for ((i=0; i<size; i++));
  do
  if [ -f "$2"/"${prefix[i]}"_deduped.bam ]; then
    echo "Counting depth of: ${prefix[i]}_deduped.bam"
    mosdepth -t 20 -n "${prefix[i]}" "$2"/"${prefix[i]}"_deduped.bam
  fi
done